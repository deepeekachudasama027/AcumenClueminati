var pool = require("../controllers/db");

pool.query(
  "INSERT into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('1.jpg','1','facebook','Book','Socialise','Mark') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('2.jpg','2','tomcruise','Tom','Big Ship','Mission Impossible') ON CONFLICT DO NOTHING ",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('3.jpg','3','dokodemodoor','Transportation','portable','Doraemon') ON CONFLICT DO NOTHING  ",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('4.jpg','4','brocode','Universal Rule','Never Ever break these rules','Bro') ON CONFLICT DO NOTHING ",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('5.jpg','5','ironman','Genius','Billionare','Superhero') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('6.jpg','6','themask','Loki','Jim Carrey','Cartoon from 90s') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('7.jpg','7','kiterunner','Two Friends','Loyalty','Afghanistan') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('8.jpg','8','privacypolicy','WhatsApp','Surveillance','Encryption') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('9.jpg','9','spot','TBBT','Sheldon','Reserved Place') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('10.jpeg','10','captainjacksparrow','Sea','Captain','Jackie') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('11.jpeg','11','firefox','Nine Tailed Fox','Open Source','Fire') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('12.jpg','12','oops','Characteristics','Internship','SEM II') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('13.jpg','13','sanamterikasam','Library','Disease','Love Story') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('14.jpg','14','naruto','Anime','Ramen','Fox') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('15.jpg','15','paw','Pav','Dog','Cat') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('16.png','16','dairymilksilk','Soft','Sweet','Milk') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('17.jpeg','17','onepiece','Straw Hat','Pirates','Treasure') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('18.jpg','18','hackerearth','Hacking','International','Platform') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('19.jpg','19','apoorvsinghkarki','UPSC','Rajendra Nagar','Tripod') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('20.jpg','20','satanshoes','NIKE','Drop','Blood') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('21.jpg','21','deathnote','Death','Anime','Notebook') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('22.jpg','22','amazon','Series','Family','Prime') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('23.jpg','23','donaldtrump','Doesnot believe in climate change','Wall','Twitter') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('24.jpg','24','mandragora','Dangerous','Magic','Harry Potter') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('25.jpg','25','christophernolan','Chris','No','L.A.N') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('26.jpg','26','streaming','Small River','Verb','Network') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('27.jpg','27','ganesh','Epic','Shiva','Writer') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('28.jpg','28','bullehshah','Sufi','Punjab','Poet') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('29.jpg','29','superman','Strong','CAL','Henry') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

pool.query(
  "INSERT  into question_clueminati (question , id, answer, hint1 , hint2, hint3 ) values ('30.jpeg','30','disarm','Take Away','Expelliarmus','Arm') ON CONFLICT DO NOTHING",
  function (err, result) {
    if (err) console.log(err);
  }
);

exports.selectrollno = (rollno, password, callback) => {
  return pool.query(
    "select rollno from  login_clueminati WHERE rollno = $1 AND password =$2",
    [rollno, password],
    callback
  );
};

exports.selecttotalhit = (rollno, callback) => {
  return pool.query(
    "select total_hit from  login_clueminati WHERE rollno = $1 ",
    [rollno],
    callback
  );
};

exports.mainpage = (rollno, callback) => {
  return pool.query(
    "select question_clueminati.question,question_clueminati.id,login_clueminati.score,rollno FROM question_clueminati INNER JOIN login_clueminati  ON question_clueminati.id=login_clueminati.cur_id where login_clueminati.rollno=$1",
    [rollno],
    callback
  );
};

exports.selectflag = (rollno, callback) => {
  return pool.query(
    "select flag FROM question_clueminati INNER JOIN login_clueminati ON question_clueminati.id=login_clueminati.cur_id where login_clueminati.rollno = $1",
    [rollno],
    callback
  );
};

exports.checkanswer = (rollno, callback) => {
  return pool.query(
    "select question_clueminati.answer,id FROM question_clueminati INNER JOIN login_clueminati ON question_clueminati.id=login_clueminati.cur_id and login_clueminati.rollno=$1",
    [rollno],
    callback
  );
};

exports.correctanswer = (score, rollno, callback) => {
  return pool.query(
    "UPDATE login_clueminati SET cur_id = cur_id+1,score=score+$1,total_hit = total_hit+1,wrong_hit=0,curhint=0 from question_clueminati where rollno =$2 and question_clueminati.id=login_clueminati.cur_id",
    [score, rollno],
    callback
  );
};

exports.updateflag = (rollno, callback) => {
  return pool.query(
    " UPDATE question_clueminati SET flag=1+flag from login_clueminati where question_clueminati.id=login_clueminati.cur_id and login_clueminati.rollno=$1 ",
    [rollno],
    callback
  );
};

exports.updatewronghit = (rollno, callback) => {
  return pool.query(
    "UPDATE login_clueminati SET wrong_hit = wrong_hit+1 from question_clueminati where rollno =$1 and question_clueminati.id=login_clueminati.cur_id",
    [rollno],
    callback
  );
};

exports.updatecurhint = (rollno, callback) => {
  return pool.query(
    "UPDATE login_clueminati SET curhint = curhint+1 from question_clueminati where rollno =$1 and question_clueminati.id=login_clueminati.cur_id",
    [rollno],
    callback
  );
};

exports.selecthint = (rollno, callback) => {
  return pool.query(
    "select login_clueminati.curhint,question_clueminati.hint1,question_clueminati.hint2,question_clueminati.hint3 FROM question_clueminati  INNER JOIN login_clueminati  ON question_clueminati.id=login_clueminati.cur_id where login_clueminati.rollno=$1",
    [rollno],
    callback
  );
};

exports.deducthint1 = (rollno, callback) => {
  return pool.query(
    "UPDATE login_clueminati SET score=score-10 where rollno =$1 ",
    [rollno],
    callback
  );
};

exports.deducthint2 = (rollno, callback) => {
  return pool.query(
    "UPDATE login_clueminati SET score=score-15 where rollno =$1 ",
    [rollno],
    callback
  );
};

exports.deducthint3 = (rollno, callback) => {
  return pool.query(
    "UPDATE login_clueminati SET score=score-20 where rollno =$1 ",
    [rollno],
    callback
  );
};

exports.coins = (rollno, callback) => {
  return pool.query(
    "select score FROM login_clueminati where rollno=$1",
    [rollno],
    callback
  );
};

exports.leaderboard = (callback) => {
  return pool.query(
    "WITH Ranking AS ( SELECT *, ROW_NUMBER() OVER( ORDER BY Score desc) AS Ranks FROM login_clueminati ) SELECT rollno , score ,ranks FROM Ranking WHERE Ranks >= 1 and Ranks <=10  ORDER BY Ranks ",
    callback
  );
};
